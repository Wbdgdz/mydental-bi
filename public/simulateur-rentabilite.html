<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulateur de Rentabilit√© - MYDental BI</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="simulateur-rentabilite.css">
</head>
<body>
    <!-- Navigation principale -->
    <nav class="main-nav">
        <a href="/" class="nav-brand">
            <img src="logo3.png" alt="Logo" class="nav-logo">
            MYDental BI
        </a>
        <ul class="nav-links">
            <li><a href="/">Tableau de bord Clinique</a></li>
            <li><a href="/doctorPerformance.html">Performance M√©decins</a></li>
            <li><a href="/simulateur-rentabilite.html" class="active">Simulateur de Rentabilit√©</a></li>
        </ul>
    </nav>

    <!-- Titre de la page -->
    <h1 class="page-title">Simulateur de Rentabilit√© des Actes</h1>

    <!-- S√©lecteur de p√©riode -->
    <div class="period-selector">
        <label for="start-date">P√©riode d'analyse - D√©but :</label>
        <input type="date" id="start-date" name="start-date">
        
        <label for="end-date">Fin :</label>
        <input type="date" id="end-date" name="end-date">
        
        <button id="apply-period">Appliquer</button>
    </div>

    <!-- Conteneur principal -->
    <div class="main-container">
        
        <!-- Section des param√®tres -->
        <div class="simulator-section">
            <h2>Param√®tres de Rentabilit√©</h2>
            <p class="section-description">
                D√©finissez les pourcentages de r√©mun√©ration du m√©decin et du co√ªt pour le centre. 
                Ces valeurs permettront de calculer la marge brute de chaque acte.
            </p>
            
            <div class="simulator-params">
                <div class="param-card">
                    <label for="remuneration-medecin">
                        <span class="param-icon">üë®‚Äç‚öïÔ∏è</span>
                        R√©mun√©ration M√©decin
                    </label>
                    <div class="input-group">
                        <input type="number" id="remuneration-medecin" value="40" min="0" max="100" step="0.1">
                        <span class="input-suffix">%</span>
                    </div>
                    <small>Pourcentage du CA vers√© au praticien</small>
                </div>
                
                <div class="param-card">
                    <label for="cout-centre">
                        <span class="param-icon">üè•</span>
                        Co√ªt Centre
                    </label>
                    <div class="input-group">
                        <input type="number" id="cout-centre" value="25" min="0" max="100" step="0.1">
                        <span class="input-suffix">%</span>
                    </div>
                    <small>Charges et co√ªts op√©rationnels</small>
                </div>
                
                <div class="param-card">
                    <label for="marge-cible">
                        <span class="param-icon">üéØ</span>
                        Marge Cible
                    </label>
                    <div class="input-group">
                        <input type="number" id="marge-cible" value="30" min="0" max="100" step="0.1">
                        <span class="input-suffix">%</span>
                    </div>
                    <small>Objectif de rentabilit√© souhait√©</small>
                </div>
            </div>

            <!-- R√©sum√© visuel -->
            <div class="params-summary">
                <div class="summary-card card-medecin">
                    <div class="summary-icon">üë®‚Äç‚öïÔ∏è</div>
                    <div class="summary-content">
                        <span class="summary-label">R√©mun√©ration M√©decin</span>
                        <span class="summary-value" id="summary-rem-med">40%</span>
                    </div>
                </div>
                
                <div class="summary-card card-centre">
                    <div class="summary-icon">üè•</div>
                    <div class="summary-content">
                        <span class="summary-label">Co√ªt Centre</span>
                        <span class="summary-value" id="summary-cout-centre">25%</span>
                    </div>
                </div>
                
                <div class="summary-card card-marge">
                    <div class="summary-icon">üìä</div>
                    <div class="summary-content">
                        <span class="summary-label">Marge Actuelle Calcul√©e</span>
                        <span class="summary-value" id="summary-marge-actuelle">35%</span>
                    </div>
                </div>
                
                <div class="summary-card card-cible">
                    <div class="summary-icon">üéØ</div>
                    <div class="summary-content">
                        <span class="summary-label">Marge Cible</span>
                        <span class="summary-value" id="summary-marge-cible">30%</span>
                    </div>
                </div>
            </div>

            <!-- Boutons d'action -->
            <div class="action-buttons">
                <button id="calculer-rentabilite" class="btn-primary">
                    <span class="btn-icon">üìä</span>
                    Calculer la Rentabilit√©
                </button>
                <button id="suggerer-tarifs" class="btn-secondary">
                    <span class="btn-icon">üí°</span>
                    Sugg√©rer Nouveaux Tarifs
                </button>
                <button id="export-data" class="btn-export">
                    <span class="btn-icon">üì•</span>
                    Exporter les R√©sultats
                </button>
            </div>
        </div>

        <!-- Section de l'analyse de rentabilit√© -->
        <div class="results-section" id="rentabilite-section" style="display: none;">
            <h2>Analyse de Rentabilit√© par Acte</h2>
            <p class="section-description">
                Vue d√©taill√©e de la rentabilit√© de chaque acte dentaire sur la p√©riode s√©lectionn√©e.
            </p>

            <!-- Statistiques globales -->
            <div class="global-stats" id="global-stats">
                <div class="stat-box">
                    <span class="stat-label">Nombre d'actes analys√©s</span>
                    <span class="stat-value" id="total-actes">0</span>
                </div>
                <div class="stat-box">
                    <span class="stat-label">CA Total</span>
                    <span class="stat-value" id="total-ca">0 DA</span>
                </div>
                <div class="stat-box">
                    <span class="stat-label">Marge Brute Totale</span>
                    <span class="stat-value" id="total-marge">0 DA</span>
                </div>
                <div class="stat-box">
                    <span class="stat-label">Marge Moyenne</span>
                    <span class="stat-value" id="marge-moyenne">0%</span>
                </div>
            </div>
            
            <!-- Tableau de rentabilit√© -->
            <div class="table-wrapper">
                <table id="rentabilite-table" class="data-table">
                    <thead>
                        <tr>
                            <th>Acte</th>
                            <th>Visites</th>
                            <th>Patients</th>
                            <th>CA Total (DA)</th>
                            <th>Heures</th>
                            <th>R√©mun√©ration M√©decin (DA)</th>
                            <th>Co√ªt Centre (DA)</th>
                            <th>Marge Brute (DA)</th>
                            <th>Marge %</th>
                            <th>Marge/Heure (DA)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td colspan="10" class="loading-cell">
                                <div class="loading-spinner"></div>
                                <span>Chargement des donn√©es...</span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Section des suggestions de tarifs -->
        <div class="results-section" id="suggestions-section" style="display: none;">
            <h2>Suggestions de Nouveaux Tarifs</h2>
            <div class="alert-info">
                <span class="alert-icon">üí°</span>
                <p>
                    Ces tarifs sugg√©r√©s permettraient d'atteindre la marge cible de <strong><span id="target-margin">30</span>%</strong> 
                    tout en conservant les pourcentages de r√©mun√©ration m√©decin et de co√ªt centre d√©finis.
                </p>
            </div>

            <!-- Statistiques des suggestions -->
            <div class="suggestion-stats" id="suggestion-stats">
                <div class="stat-box stat-positive">
                    <span class="stat-label">Actes √† augmenter</span>
                    <span class="stat-value" id="actes-augmenter">0</span>
                </div>
                <div class="stat-box stat-negative">
                    <span class="stat-label">Actes √† diminuer</span>
                    <span class="stat-value" id="actes-diminuer">0</span>
                </div>
                <div class="stat-box">
                    <span class="stat-label">Variation moyenne</span>
                    <span class="stat-value" id="variation-moyenne">0%</span>
                </div>
            </div>
            
            <div class="table-wrapper">
                <table id="suggestions-table" class="data-table">
                    <thead>
                        <tr>
                            <th>Acte</th>
                            <th>Prix Actuel (DA)</th>
                            <th>Tarif Sugg√©r√© (DA)</th>
                            <th>Variation</th>
                            <th>Marge Actuelle</th>
                            <th>Marge Cible</th>
                            <th>CA Actuel (DA)</th>
                            <th>CA Projet√© (DA)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td colspan="8" class="loading-cell">
                                <div class="loading-spinner"></div>
                                <span>Chargement des suggestions...</span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

    </div>

    <!-- Scripts -->
    <script type="module" src="./simulator/simulateurRentabilite.js"></script>
    <script type="module" src="./utilities/utils.js"></script>
</body>
</html>
