<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analyse des Performances des Médecins</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="doctor-performance.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
    
    <nav class="main-nav">
        <a href="/" class="nav-brand">
            <img src="logo3.png" alt="Logo" class="nav-logo">
            MYDental BI
        </a>
        <ul class="nav-links">
            <li><a href="/">Tableau de bord Clinique</a></li>
            <li><a href="/doctorPerformance.html" class="active">Performance Médecins</a></li>
            <li><a href="/simulateur-rentabilite.html">Simulateur de Rentabilité</a></li>
            <li><a href="/financial-analysis.html">Analyse Financière</a></li>
            <li><a href="/patient-analysis.html">Analyse Patients</a></li>
        </ul>
            <button id="logout-btn" class="nav-logout-btn">Déconnexion</button>
    </nav>

    <h1 class="page-title">Analyse des Performances des Médecins</h1>

    <div class="period-selector">
        <label for="doctor-select">Médecin :</label>
        <select id="doctor-select">
            </select>

        <label for="start-date">Début :</label>
        <input type="date" id="start-date" name="start-date">
        
        <label for="end-date">Fin :</label>
        <input type="date" id="end-date" name="end-date">
        
        <button id="apply-period">Appliquer</button>
    </div>

    <div id="stats-card-container">
        <div class="stats-card">
            <div class="stats-title">Patients uniques</div>
            <div class="stats-value" id="unique-patients">Chargement...</div>
        </div>

        <div class="stats-card">
            <div class="stats-title">Visites</div>
            <div class="stats-value" id="total-visits">Chargement...</div>
        </div>

        <div class="stats-card">
            <div class="stats-title">Patients (sans retour)</div>
            <div class="stats-value" id="patients-premiere-visite-pas-retour">Chargement...</div>
        </div>
        
        <div class="stats-card">
            <div class="stats-title">Nouveaux patients</div>
            <div class="stats-value" id="new-patients">Chargement...</div>
        </div>

        <div class="stats-card">
            <div class="stats-title">Visites (Nouveaux patients)</div>
            <div class="stats-value" id="visits-generated-by-new-patients">Chargement...</div>
        </div>
        
        <div class="stats-card">
            <div class="stats-title">Patients (1ère visite clinique)</div>
            <div class="stats-value" id="patients-premiere-visite">Chargement...</div>
        </div>

        <div class="stats-card">
            <div class="stats-title">Visites (1ère visite clinique)</div>
            <div class="stats-value" id="visites-premiere-visite">Chargement...</div>
        </div>

        <div class="stats-card">
            <div class="stats-title">Patients fidèles</div>
            <div class="stats-value" id="loyal-patients">Chargement...</div>
        </div>

        <div class="stats-card">
            <div class="stats-title">Visites de suivi</div>
            <div class="stats-value" id="follow-up-visits">Chargement...</div>
        </div>

        <div class="stats-card">
            <div class="stats-title">Total des revenus</div>
            <div class="stats-value" id="total-revenue-consultations">Chargement...</div>
        </div>

        <div class="stats-card">
            <div class="stats-title">Heures patient</div>
            <div class="stats-value" id="total-hours-worked">Chargement...</div>
        </div>

        <div class="stats-card">
            <div class="stats-title">CA par heure</div>
            <div class="stats-value" id="revenue-per-hour">Chargement...</div>
        </div>

        <div class="stats-card">
            <div class="stats-title">Temps Patient moyen</div>
            <div class="stats-value" id="hours-worked">Chargement...</div>
        </div>

        <div class="stats-card">
            <div class="stats-title">Temps d'attente moyen</div>
            <div class="stats-value" id="avg-waiting-time">Chargement...</div>
        </div>
    </div>

    <div class="charts-container">
        
        <div class="chart-container">
            <div class="chart-title">Analyse : Visites vs Revenus</div>
            <svg id="visits-revenue-chart"></svg>
        </div>

        <div class="table-container">
            <h2>Détail des Actes Effectués</h2>
            <table id="actes-table">
                <thead>
                    <tr>
                        <th>Acte</th>
                        <th>Patients</th>
                        <th>Nombre d'actes</th>
                        <th>Revenus (DA)</th>
                        <th>Heures</th>
                        <th>Coût/Heure (DA)</th>
                    </tr>
                </thead>
                <tbody>
                    </tbody>
            </table>
        </div>

        <div class="chart-container">
            <div class="chart-title">Analyse de la fidélité des patients</div>
            <svg id="patients-chart"></svg>
        </div>
        
        <div class="chart-container">
            <div class="chart-title">Évolution du Temps</div>
            <svg id="performance-chart"></svg>
        </div>

        <div class="chart-container">
            <div class="chart-title">Génération des rendez-vous</div>
            <svg id="appointments-chart"></svg> 
        </div>

        <div class="chart-container">
            <div class="chart-title">Temps de travail</div>
            <svg id="work-time-chart"></svg> 
        </div>

        <div class="chart-container">
            <div class="chart-title">Temps d'Attente Moyen (Heatmap)</div>
            <svg id="waiting-time-heatmap"></svg>
        </div>

    </div>

    <footer class="site-footer">
        <div class="w-full mx-auto">
            <span>© 2025 <a href="#">MyDental BI</a>. All Rights Reserved.</span>
        </div>
    </footer>

    <button id="back-to-top" title="Retour en haut">↑</button>

    <script type="module" src="./doctor/main.js"></script>
    <script type="module" src="./utilities/utils.js"></script> </body>
</html>